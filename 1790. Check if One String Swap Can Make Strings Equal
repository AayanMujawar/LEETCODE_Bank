bool areAlmostEqual(char* s1, char* s2) {
    int hash[128] = {0};
    int diffIdx[2], diffCount = 0;

    for (int i = 0; s1[i] != '\0'; i++) {
        if (s1[i] != s2[i]) {
            if (diffCount >= 2) return false;
            diffIdx[diffCount++] = i;
        }
        hash[s1[i]]++;
        hash[s2[i]]--;
    }

    for (int i = 0; i < 128; i++)
        if (hash[i] != 0) return false;

    if (diffCount == 0) return true;
    if (diffCount != 2) return false;

    int i1 = diffIdx[0], i2 = diffIdx[1];
    return (s1[i1] == s2[i2] && s1[i2] == s2[i1]);
}
