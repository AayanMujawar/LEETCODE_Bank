#include <stdio.h>
#include <stdlib.h>
#include <math.h>

// Comparator for qsort (sort by absolute value)
int compareAbs(const void *a, const void *b) {
    long long x = llabs(*(int*)a);
    long long y = llabs(*(int*)b);
    if (x < y) return -1;
    else if (x > y) return 1;
    else return 0;
}

long long perfectPairs(int* nums, int n) {
    // Step 1: Sort array by absolute value
    qsort(nums, n, sizeof(int), compareAbs);

    long long count = 0;
    int j = 0;

    // Step 2: Two-pointer traversal
    for (int i = 0; i < n; i++) {
        // Move j forward while |nums[j]| <= 2 * |nums[i]|
        while (j < n && llabs(nums[j]) <= 2LL * llabs(nums[i])) {
            j++;
        }

        // Add all valid pairs (i, i+1 ... j-1)
        count += (j - i - 1);
    }

    return count;
}    
